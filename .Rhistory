require(pls)
set.seed (27)
pcr_model <- pls::pcr(simY~., data = simdata, scale = TRUE, validation = "CV")
summary(pcr_model)
# Plot the root mean squared error
validationplot(pcr_model)
require(pls)
set.seed (27)
pcr_model <- pls::pcr(simY~., data = simdata, scale = TRUE, validation = "CV")
summary(pcr_model)
# Plot the cross validation MSE
validationplot(pcr_model, val.type="MSEP")
require(pls)
set.seed (27)
split = sample.split(simdata$simY, SplitRatio = 0.80)
require(pls)
library(caTools)
set.seed (27)
split = sample.split(simdata$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
pcr_model <- pls::pcr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pcr_model)
# Plot the cross validation MSE
validationplot(pcr_model, val.type="MSEP")
require(pls)
library(caTools)
set.seed (27)
split = sample.split(simdata$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
pcr_model <- pls::pcr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pcr_model)
# Plot the cross validation MSE
validationplot(pcr_model, val.type="MSEP")
#test error
pcr_pred <- predict(pcr_model, test, ncomp = 3)
mean((pcr_pred - y_test)^2)
View(test)
require(pls)
library(caTools)
set.seed (27)
split = sample.split(simdata$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
pcr_model <- pls::pcr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pcr_model)
# Plot the cross validation MSE
validationplot(pcr_model, val.type="MSEP")
#test error
y_test <- test[, simY]
pcr_pred <- predict(pcr_model, test, ncomp = 3)
mean((pcr_pred - y_test)^2)
mean((pcr_pred - y_test)^2)
View(y_test)
require(pls)
library(caTools)
set.seed (27)
split = sample.split(simdata$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
pcr_model <- pls::pcr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pcr_model)
# Plot the cross validation MSE
validationplot(pcr_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pcr_model, test, ncomp = 3)
mean((pcr_pred - y_test)^2)
require(pls)
library(caTools)
set.seed (27)
split = sample.split(simdata$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
pcr_model <- pls::pcr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pcr_model)
# Plot the cross validation MSE
validationplot(pcr_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pcr_model, test, ncomp = 7)
mean((pcr_pred - y_test)^2)
?pls
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 7)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 9)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 7)
mean((pcr_pred - y_test)^2)
require(pls)
library(caTools)
set.seed (27)
split = sample.split(simdata$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
pcr_model <- pls::pcr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pcr_model)
# Plot the cross validation MSE
validationplot(pcr_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pcr_model, test, ncomp = 8)
mean((pcr_pred - y_test)^2)
require(pls)
library(caTools)
set.seed (27)
split = sample.split(simdata$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
pcr_model <- pls::pcr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pcr_model)
# Plot the cross validation MSE
validationplot(pcr_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pcr_model, test, ncomp = 7)
mean((pcr_pred - y_test)^2)
require(pls)
library(caTools)
set.seed (27)
split = sample.split(simdata$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
pcr_model <- pls::pcr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pcr_model)
# Plot the cross validation MSE
validationplot(pcr_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pcr_model, test, ncomp = 9)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 9)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 6)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 3)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 4)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 5)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 4)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 2)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 3)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 4)
mean((pcr_pred - y_test)^2)
simdata_812 <- data_gen(n=100, g=8, p_g = 12)
model812<-lm(simY~., data = train)
summary(model812)
simdata_812 <- data_gen(n=100, g=8, p_g = 12)
model812<-lm(simY~., data = train)
summary(model812)
simdata_812 <- data_gen(n=100, g=8, p_g = 12)
model812<-lm(simY~., data = train)
summary(model812)
#test error
lm812_pred <- predict(model812, test)
mean((pcr_pred - y_test)^2)
simdata_1212 <- data_gen(n=100, g=12, p_g = 12)
model1212<-lm(simY~., data = train)
summary(model1212)
#test error
lm812_pred <- predict(model1212, test)
mean((pcr_pred - y_test)^2)
simdata_812 <- data_gen(n=100, g=8, p_g = 12)
model812<-lm(simY~., data = train)
summary(model812)
#test error
lm812_pred <- predict(model812, test)
mean((pcr_pred - y_test)^2)
simdata_812 <- data_gen(n=100, g=8, p_g = 12)
model812<-lm(simY~., data = train)
summary(model812)
#test error
lm812_pred <- predict(model812, test)
mean((lm812_pred - y_test)^2)
simdata_1212 <- data_gen(n=100, g=12, p_g = 12)
model1212<-lm(simY~., data = train)
summary(model1212)
#test error
lm1212_pred <- predict(model1212, test)
mean((lm1212_pred - y_test)^2)
library(MASS)
data_gen <- function (n, g, p_g) {
simX <<- data.frame(ID=seq(1:n))
sum_g <- data.frame(ID=seq(1:n))
sapply(seq(1:g), function (i) {
temp_p <- qr.Q(qr(matrix(rnorm(p_g^2), p_g)))
Sigma_g <- abs(crossprod(temp_p, temp_p*(p_g:1)))
simX_tmp <- as.data.frame(mvrnorm(n=n, mu=runif(p_g, min = 0, max = 10), Sigma=Sigma_g))
colnames(simX_tmp) <- paste0("g", i, "q", seq(1:p_g))
simX <<- cbind(simX, simX_tmp)
sum_g <<- cbind(sum_g, rowSums(simX_tmp))
})
colnames(sum_g) <- c("ID",seq(1:g))
betas <<- rnorm(g+1, 0, 1)*10
error <<- rnorm(n, 0, 5)
simY <<- rowSums(t(t(sum_g[2:ncol(sum_g)]) * betas[2:length(betas)])) + betas[1] + error
simData <<- cbind(simX, simY)
}
simdata <- data_gen(n=1000, g=3, p_g = 3)
res <- cor(simdata)
library(corrplot)
corrplot(res, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
require(pls)
library(caTools)
set.seed (27)
split = sample.split(simdata$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
pcr_model <- pls::pcr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pcr_model)
# Plot the cross validation MSE
validationplot(pcr_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pcr_model, test, ncomp = 9)
mean((pcr_pred - y_test)^2)
pls_model <- pls::plsr(simY~., data = train, scale = TRUE, validation = "CV")
summary(pls_model)
# Plot the cross validation MSE
validationplot(pls_model, val.type="MSEP")
#test error
y_test <- test[, 11]
pcr_pred <- predict(pls_model, test, ncomp = 4)
mean((pcr_pred - y_test)^2)
simdata_812 <- data_gen(n=100, g=8, p_g = 12)
model812<-lm(simY~., data = train)
summary(model812)
#test error
lm812_pred <- predict(model812, test)
mean((lm812_pred - y_test)^2)
simdata_1212 <- data_gen(n=100, g=12, p_g = 12)
model1212<-lm(simY~., data = train)
summary(model1212)
#test error
lm1212_pred <- predict(model1212, test)
mean((lm1212_pred - y_test)^2)
simdata_812 <- data_gen(n=100, g=8, p_g = 12)
split = sample.split(simdata_812$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
model812<-lm(simY~., data = train)
summary(model812)
#test error
lm812_pred <- predict(model812, test)
mean((lm812_pred - y_test)^2)
simdata_1212 <- data_gen(n=100, g=12, p_g = 12)
split = sample.split(simdata_1212$simY, SplitRatio = 0.80)
model1212<-lm(simY~., data = train)
summary(model1212)
#test error
lm1212_pred <- predict(model1212, test)
mean((lm1212_pred - y_test)^2)
simdata_1212 <- data_gen(n=100, g=12, p_g = 12)
split = sample.split(simdata_1212$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
model1212<-lm(simY~., data = train)
summary(model1212)
#test error
lm1212_pred <- predict(model1212, test)
mean((lm1212_pred - y_test)^2)
simdata_812 <- data_gen(n=100, g=8, p_g = 12)
split = sample.split(simdata_812$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
model812<-lm(simY~., data = train)
summary(model812)
#test error
lm812_pred <- predict(model812, test)
mean((lm812_pred - y_test)^2)
set.seed (27)
simdata_812 <- data_gen(n=100, g=8, p_g = 12)
split = sample.split(simdata_812$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
model812<-lm(simY~., data = train)
summary(model812)
#test error
lm812_pred <- predict(model812, test)
mean((lm812_pred - y_test)^2)
set.seed (27)
simdata_1212 <- data_gen(n=100, g=12, p_g = 12)
split = sample.split(simdata_1212$simY, SplitRatio = 0.80)
train = subset(simdata, split == TRUE)
test = subset(simdata, split == FALSE)
model1212<-lm(simY~., data = train)
summary(model1212)
#test error
lm1212_pred <- predict(model1212, test)
mean((lm1212_pred - y_test)^2)
set.seed(27)
simdata <- data_gen(n=1000, g=3, p_g = 3)
res <- cor(simdata)
library(corrplot)
corrplot(res, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
simdata <- data_gen(n=1000, g=3, p_g = 3)
res <- cor(simdata)
library(corrplot)
corrplot(res, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
library(MASS)
data_gen <- function (n, g, p_g) {
simX <<- data.frame(ID=seq(1:n))
sum_g <- data.frame(ID=seq(1:n))
sapply(seq(1:g), function (i) {
temp_p <- qr.Q(qr(matrix(rnorm(p_g^2), p_g)))
Sigma_g <- abs(crossprod(temp_p, temp_p*(p_g:1)))
simX_tmp <- as.data.frame(mvrnorm(n=n, mu=runif(p_g, min = 0, max = 10), Sigma=Sigma_g))
colnames(simX_tmp) <- paste0("g", i, "q", seq(1:p_g))
simX <<- cbind(simX, simX_tmp)
sum_g <<- cbind(sum_g, rowSums(simX_tmp))
})
colnames(sum_g) <- c("ID",seq(1:g))
betas <<- rnorm(g+1, 0, 1)*10
error <<- rnorm(n, 0, 5)
simY <<- rowSums(t(t(sum_g[2:ncol(sum_g)]) * betas[2:length(betas)])) + betas[1] + error
simData <<- cbind(simX, simY)
}
set.seed(27)
simdata <- data_gen(n=1000, g=3, p_g = 3)
res <- cor(simdata)
library(corrplot)
corrplot(res, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
?corrplot
set.seed(27)
simdata <- data_gen(n=1000, g=3, p_g = 3)
res <- cor(simdata)
library(corrplot)
corrplot(res, type = "upper", order = "hclust",
tl.col = "black")
res
set.seed(27)
simdata <- data_gen(n=1000, g=3, p_g = 3)
res <- cor(simdata)
library(corrplot)
corrplot::corrplot(res, type = "upper", order = "hclust",
tl.col = "black")
set.seed(27)
simdata <- data_gen(n=1000, g=3, p_g = 3)
res <- cor(simdata)
library(corrplot)
corrplot::corrplot(res, type = "upper", order = "hclust",
tl.col = "black")
set.seed(55)
simdata <- data_gen(n=1000, g=3, p_g = 3)
res <- cor(simdata)
library(corrplot)
corrplot::corrplot(res, type = "upper", order = "hclust",
tl.col = "black")
set.seed(88)
simdata <- data_gen(n=1000, g=3, p_g = 3)
res <- cor(simdata)
library(corrplot)
corrplot::corrplot(res, type = "upper", order = "hclust",
tl.col = "black")
set.seed(666)
simdata <- data_gen(n=1000, g=3, p_g = 3)
res <- cor(simdata)
library(corrplot)
corrplot::corrplot(res, type = "upper", order = "hclust",
tl.col = "black")
set.seed(1000)
simdata <- data_gen(n=1000, g=3, p_g = 3)
res <- cor(simdata)
library(corrplot)
corrplot::corrplot(res, type = "upper", order = "hclust",
tl.col = "black")
library(caret)
library(leaps)
library(MASS)
# Fit the full model
#full.model <- lm(Mail_Return_Rate_CEN_2010 ~., data = train)
# Stepwise regression model
#step.model <- stepAIC(full.model, direction = "forward", steps = 10,
#                      trace = FALSE)
#summary(step.model)
#models <- regsubsets(Mail_Return_Rate_CEN_2010~., data = train, nvmax = 10, method = "forward")
#summary(models)
library(olsrr)
model<-lm(Mail_Return_Rate_CEN_2010~., data = train)
library(readr)
library(dplyr)
library(caTools)
set.seed(27)
data <- read_csv("pdb2016bgv8_us_clean (1).csv")
data <- filter(data, data$State_name == "Texas" & data$County_name == "Travis County")
drop_columns <- c("TEA_Update_Leave_CEN_2010", "BILQ_Mailout_count_CEN_2010", "BILQ_Frms_CEN_2010",
"pct_TEA_Update_Leave_CEN_2010", "pct_BILQ_Mailout_count_CEN_2010", "Low_Response_Score",
"Census_Mail_Returns_CEN_2010")
data <- data[ , !(names(data) %in% drop_columns)]
data_noID <- data[9:ncol(data)]
drop_LD_columns <- c("AIAN_LAND", "Tot_Population_CEN_2010", "Females_CEN_2010", "Females_ACS_10_14",
"Pop_65plus_CEN_2010", "Pop_65plus_ACS_10_14", "Non_Inst_GQ_CEN_2010", "Pop_5yrs_Over_ACS_10_14",
"Pop_25yrs_Over_ACS_10_14", "ENG_VW_ACS_10_14", "NonFamily_HHD_CEN_2010", "NonFamily_HHD_ACS_10_14",
"Tot_Prns_in_HHD_CEN_2010", "Tot_Occp_Units_CEN_2010", "Tot_Occp_Units_ACS_10_14", "Tot_Vacant_Units_CEN_2010",
"Tot_Vacant_Units_ACS_10_14", "Owner_Occp_HU_CEN_2010", "Owner_Occp_HU_ACS_10_14",
"Valid_Mailback_Count_CEN_2010", "pct_Females_CEN_2010", "pct_Pop_5yrs_Over_ACS_10_14",
"pct_Not_MrdCple_HHD_CEN_2010", "pct_Vacant_Units_ACS_10_14", "pct_Owner_Occp_HU_CEN_2010",
"pct_TEA_MailOutMailBack_CEN_2010", "pct_Deletes_CEN_2010")
data_noID_noMC <- data_noID [ , !(names(data_noID) %in% drop_LD_columns)]
data_noID_noMC <- data_noID_noMC [, -grep("pct_", colnames(data_noID_noMC))]
split = sample.split(data_noID_noMC$Mail_Return_Rate_CEN_2010, SplitRatio = 0.80)
train = subset(data_noID_noMC, split == TRUE)
test = subset(data_noID_noMC, split == FALSE)
library(caret)
library(leaps)
library(MASS)
# Fit the full model
#full.model <- lm(Mail_Return_Rate_CEN_2010 ~., data = train)
# Stepwise regression model
#step.model <- stepAIC(full.model, direction = "forward", steps = 10,
#                      trace = FALSE)
#summary(step.model)
#models <- regsubsets(Mail_Return_Rate_CEN_2010~., data = train, nvmax = 10, method = "forward")
#summary(models)
library(olsrr)
model<-lm(Mail_Return_Rate_CEN_2010~., data = train)
FWDfit.p<-ols_step_forward_p(model,penter=.0002)
#This gives you the short summary of the models at each step
print("Forward")
FWDfit.p
BWDfit.p <-ols_step_backward_p(model, prem = .000001)
#This gives you the short summary of the models at each step
print("Backward")
BWDfit.p
BWDfit.p
BWDfit.p$model
BWDfit.p$rsquare
BWDfit.p$indvar
View(BWDfit.p)
BWDfit.p$model$coefficients
