\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Assignment 2: Classification},
            pdfauthor={Ethan Tenison},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Assignment 2: Classification}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Ethan Tenison}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{2/26/2020}


\begin{document}
\maketitle

\hypertarget{q1-classification}{%
\section{Q1: Classification}\label{q1-classification}}

Residential solar photovoltaics (PV) -- the roof-mounted panels that
generate electricity -- are spreading throughout Austin. Two key drivers
of the individual adoption decision are Wealth in K\$, and Attitude on a
scale beween 1-4. Suppose you collect data on a group of Austin
homeowners where \(X_{1}\) = Wealth in kdollars \(X_{2}\) = Attitude,
and Y = whether homeowners adopt solar PV. We fit a logistic regression
and produce estimated coefficients β0 = −6, β1 = 0.05, and β2 = 1.

\hypertarget{a-write-out-the-function.}{%
\paragraph{(a) Write out the
function.}\label{a-write-out-the-function.}}

\(log\)\(\frac{p}{(1-p)}\) = \(-6\) + \(0.05\)\(X_{1}\) + \(1\)\(X_{2}\)

\hypertarget{b-estimate-the-probability-that-a-homeowner-with-wealth-of-40k-and-an-attitude-of-3.5-adopts}{%
\paragraph{(b) Estimate the probability that a homeowner with Wealth of
\$40k and an Attitude of 3.5
adopts}\label{b-estimate-the-probability-that-a-homeowner-with-wealth-of-40k-and-an-attitude-of-3.5-adopts}}

solar PV.

\(log\)\(\frac{p}{(1-p)}\) = \(-6\) + \(0.05\)\((40)\) + \(1\)\((3.5)\)
\(log\)\(\frac{p}{(1-p)}\) = \(-6\) + \(2\) + \(3.5\)
\(log\)\(\frac{p}{(1-p)}\) = \(-0.5\) \(\frac{p}{(1-p)}\) =
\(exp\)\((-0.5)\) \(\frac{p}{(1-p)}\) = \(0.60653065971\) \(p\) =
\(\frac{0.60653065971}{(1+0.60653065971)}\) \(p\) = \(37.8\)\%

\hypertarget{c-what-wealth-value-would-the-homeowner-in-part-b-need-to-have-in-order-to-have-a-50}{%
\paragraph{(c) What Wealth value would the homeowner in part (b) need to
have in order to have a
50\%}\label{c-what-wealth-value-would-the-homeowner-in-part-b-need-to-have-in-order-to-have-a-50}}

chance of adopting solar PV?

\(log\)\(\frac{0.5}{(1-0.5)}\) = \(-6\) + \(0.05\)\(X_{1}\) +
\(1\)\((3.5)\) \(log\)\((1)\) = \(-6\) + \(0.05\)\(X_{1}\) +
\(1\)\((3.5)\) \(0\) = \(-6\) + \(0.05\)\(X_{1}\) + \(1\)\((3.5)\)
\(2.5\) = \(0.05\)\(X_{1}\) \(X_{1}\) = \(50K\)

\hypertarget{d-what-if-you-added-a-qualitative-variable-tesla_owner-as-x3-that-indicated-whether-the}{%
\paragraph{(d) What if you added a qualitative variable Tesla\_Owner as
X3, that indicated whether
the}\label{d-what-if-you-added-a-qualitative-variable-tesla_owner-as-x3-that-indicated-whether-the}}

household owns a Tesla plug-in electric car. Tesla cars are quite
expensive, and those with solar PV systems benefit considerably from not
paying for fuel. Write out the new function. What value might you expect
for new Tesla\_Owner coefficient (β3) in this new function? How might
you expect β1 and β2 in the NEW function to be different from β1 and β2
in the OLD function?

\(\beta_{3}\) will probably be much larger than \(\beta_{1}\) and
\(\beta_{2}\) because Tesla owners benefit from photovoltaics. The value
for \(\beta_{1}\) will probably decrease slightly because wealth is
correlated with owning a Tesla, and some variation previously assigned
to \(\beta_{1}\) will be included in \(\beta_{3}\). It is unlikely that
\(\beta_{2}\) will change because attitude towards photovoltacics might
not be associated with Tesla ownership.

\hypertarget{e-what-is-missing-from-this-admittedly-simplified-analysis}{%
\paragraph{(e) What is missing from this (admittedly simplified)
analysis?}\label{e-what-is-missing-from-this-admittedly-simplified-analysis}}

We might include an interaction variable for \(X_{1}\) and \(X_{3}\).
You might also want to include a variable for tax rebates. Not all
homeowners may qualify, and that could have a big impact on their
decision. Another variable that might be important is the avg price of
PV panels, which have been declining.

\hypertarget{q2-classification-in-data-55-points}{%
\section{Q2: Classification in data (55
points)}\label{q2-classification-in-data-55-points}}

Water use per person in Austin is currently at an historic low, but it
can still be an issue -- particularly when we are experience a dry,
Texas summer. Please use the Austin Water - Residential Water
Consumption data
(\url{https://data.austintexas.gov/Utilities-and-City-Services/Austin-Water-Residential-WaterConsumption/sxk7-7k6z})
for this question. Take note -- this is a real world data set and as
such may not be clean.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(dplyr)}
\KeywordTok{library}\NormalTok{(janitor)}
\KeywordTok{library}\NormalTok{(reshape2)}
\NormalTok{df <{-}}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"Austin\_Water\_{-}\_Residential\_Water\_Consumption.csv"}\NormalTok{)}
\NormalTok{df <{-}}\StringTok{ }\KeywordTok{clean\_names}\NormalTok{(df)}
\NormalTok{df}\OperatorTok{$}\NormalTok{year <{-}}\StringTok{ }\KeywordTok{substr}\NormalTok{(df}\OperatorTok{$}\NormalTok{year\_month, }\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\NormalTok{df}\OperatorTok{$}\NormalTok{year <{-}}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(df}\OperatorTok{$}\NormalTok{year)}
\NormalTok{df}\OperatorTok{$}\NormalTok{month <{-}}\StringTok{ }\KeywordTok{substr}\NormalTok{(df}\OperatorTok{$}\NormalTok{year\_month, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{)}
\NormalTok{df}\OperatorTok{$}\NormalTok{month <{-}}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(df}\OperatorTok{$}\NormalTok{month)}
\NormalTok{df <{-}}\StringTok{ }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{select}\NormalTok{(df, }\OperatorTok{{-}}\KeywordTok{c}\NormalTok{(year\_month))}
\NormalTok{df}\OperatorTok{$}\NormalTok{customer\_class <{-}}\StringTok{ }\KeywordTok{gsub}\NormalTok{(}\StringTok{" {-} "}\NormalTok{, }\StringTok{"\_"}\NormalTok{, df}\OperatorTok{$}\NormalTok{customer\_class)}
\NormalTok{df <{-}}\StringTok{ }\KeywordTok{filter}\NormalTok{(df, postal\_code }\OperatorTok{!=}\StringTok{ ""}\NormalTok{)}
\NormalTok{df}\OperatorTok{$}\NormalTok{total\_gallons[}\KeywordTok{is.na}\NormalTok{(df}\OperatorTok{$}\NormalTok{total\_gallons)] <{-}}\StringTok{ }\DecValTok{0}
\NormalTok{dfwide <{-}}\StringTok{ }\KeywordTok{dcast}\NormalTok{(}\DataTypeTok{data=}\NormalTok{df, postal\_code}\OperatorTok{+}\NormalTok{month}\OperatorTok{+}\NormalTok{year}\OperatorTok{\textasciitilde{}}\NormalTok{customer\_class, }\DataTypeTok{value.var=} \StringTok{\textquotesingle{}total\_gallons\textquotesingle{}}\NormalTok{)}
\NormalTok{dfwide <{-}}\StringTok{ }\KeywordTok{clean\_names}\NormalTok{(dfwide)}
\NormalTok{df}\OperatorTok{$}\NormalTok{total\_gallons[}\KeywordTok{is.na}\NormalTok{(df}\OperatorTok{$}\NormalTok{total\_gallons)] <{-}}\StringTok{ }\DecValTok{0}
\NormalTok{dfwide[}\KeywordTok{is.na}\NormalTok{(dfwide)] <{-}}\StringTok{ }\DecValTok{0}
\end{Highlighting}
\end{Shaded}

\hypertarget{a-produce-some-numerical-and-graphical-summaries-of-the-water-data.-what-patterns-do-you}{%
\paragraph{(a) Produce some numerical and graphical summaries of the
Water data. What patterns do
you}\label{a-produce-some-numerical-and-graphical-summaries-of-the-water-data.-what-patterns-do-you}}

see?

Total water consumption declined after water restrictions were
introduced in 2018. Irrigation remained basically the same even though
these numbers should have declined as well.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2)}
\KeywordTok{options}\NormalTok{(}\DataTypeTok{scipen=}\DecValTok{999}\NormalTok{)}
\KeywordTok{print}\NormalTok{(}\KeywordTok{summary}\NormalTok{(dfwide))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   postal_code       month           year      irrigation_multi_family
##  78613  :  94   06     : 377   Min.   :2012   Min.   :       0       
##  78617  :  94   07     : 377   1st Qu.:2013   1st Qu.:   28050       
##  78652  :  94   08     : 377   Median :2015   Median :  565300       
##  78653  :  94   09     : 377   Mean   :2015   Mean   : 1434146       
##  78660  :  94   10     : 377   3rd Qu.:2017   3rd Qu.: 1923350       
##  78701  :  94   01     : 376   Max.   :2019   Max.   :24298000       
##  (Other):3858   (Other):2161                                         
##  irrigation_residential  multi_family       residential       
##  Min.   :      0        Min.   :       0   Min.   :        0  
##  1st Qu.:      0        1st Qu.: 2370450   1st Qu.:  7162150  
##  Median :  12450        Median :11954550   Median : 19374950  
##  Mean   :  71293        Mean   :14931954   Mean   : 25883596  
##  3rd Qu.:  45675        3rd Qu.:19102750   3rd Qu.: 39344625  
##  Max.   :2704000        Max.   :92554300   Max.   :125645900  
## 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{total\_water <{-}}\StringTok{ }\NormalTok{df }\OperatorTok{\%>\%}\StringTok{ }\KeywordTok{group\_by}\NormalTok{(year, customer\_class) }\OperatorTok{\%>\%}\StringTok{ }
\StringTok{                }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{total\_gallons =} \KeywordTok{sum}\NormalTok{(total\_gallons))}

\NormalTok{tw <{-}}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(total\_water, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{year, }\DataTypeTok{y=}\NormalTok{total\_gallons, }\DataTypeTok{group=}\NormalTok{customer\_class, }\DataTypeTok{color=}\NormalTok{customer\_class)) }\OperatorTok{+}
\StringTok{        }\KeywordTok{geom\_line}\NormalTok{()}
\KeywordTok{print}\NormalTok{(tw)}
\end{Highlighting}
\end{Shaded}

\includegraphics{assignment2_files/figure-latex/a-1.pdf}

\hypertarget{b-create-a-binary-variable-hiresirr-that-contains-a-1-if-irrigation_residential-contains-a-value}{%
\paragraph{(b) Create a binary variable, HiResIrr, that contains a 1 if
Irrigation\_Residential contains a
value}\label{b-create-a-binary-variable-hiresirr-that-contains-a-1-if-irrigation_residential-contains-a-value}}

above its mean, and a 0 if Irrigation\_Residential contains a value
below its mean. Use the full data set to perform a logistic regression
with HiResIrr as the response and other variables as predictors (besides
the original Irrigation\_Residential variable). Provide a summary of
your obtained results. Do any of the predictors appear to be
statistically significant? If so, which ones? Does it look like
residential irrigation has decreased over the past few years?

None of the postal codes were statistically significant, so I removed
them.Year, multi-family, and residential were significant and had a
positive impact on the probability of HiResIrr being above the mean. For
every one unit increase in year is associated with an increase in the
log-odds of being above the mean by 0.055649003832. When I converted
month to a factor, only the hottest months of the year are significant
in the positive direction. Irrigation\_multifamily was significant in
the negative direction.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(caTools)}
\NormalTok{logdf <{-}}\StringTok{ }\NormalTok{dfwide}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(logdf}\OperatorTok{$}\NormalTok{irrigation\_residential))\{}
                  \ControlFlowTok{if}\NormalTok{(logdf}\OperatorTok{$}\NormalTok{irrigation\_residential[i] }\OperatorTok{>}\StringTok{ }\KeywordTok{mean}\NormalTok{(logdf}\OperatorTok{$}\NormalTok{irrigation\_residential))\{        }
\NormalTok{                    logdf}\OperatorTok{$}\NormalTok{HiResIrr[i] <{-}}\StringTok{ }\DecValTok{1}               
\NormalTok{                  \}}
                  \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{(logdf}\OperatorTok{$}\NormalTok{irrigation\_residential[i] }\OperatorTok{<=}\StringTok{ }\KeywordTok{mean}\NormalTok{(logdf}\OperatorTok{$}\NormalTok{irrigation\_residential))\{        }
\NormalTok{                    logdf}\OperatorTok{$}\NormalTok{HiResIrr[i] <{-}}\StringTok{ }\DecValTok{0} 
\NormalTok{                  \}}
\NormalTok{\}}
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{88}\NormalTok{)}
\NormalTok{split =}\StringTok{ }\KeywordTok{sample.split}\NormalTok{(logdf}\OperatorTok{$}\NormalTok{HiResIrr, }\DataTypeTok{SplitRatio =} \FloatTok{0.75}\NormalTok{)}
\NormalTok{logdf <{-}}\StringTok{ }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{select}\NormalTok{(logdf, }\OperatorTok{{-}}\KeywordTok{c}\NormalTok{(irrigation\_residential, postal\_code))}
\NormalTok{train =}\StringTok{ }\KeywordTok{subset}\NormalTok{(logdf, split }\OperatorTok{==}\StringTok{ }\OtherTok{TRUE}\NormalTok{)}
\NormalTok{test =}\StringTok{ }\KeywordTok{subset}\NormalTok{(logdf, split }\OperatorTok{==}\StringTok{ }\OtherTok{FALSE}\NormalTok{)}

\NormalTok{model <{-}}\StringTok{ }\KeywordTok{glm}\NormalTok{(HiResIrr }\OperatorTok{\textasciitilde{}}\NormalTok{.,}\DataTypeTok{family=}\KeywordTok{binomial}\NormalTok{(}\DataTypeTok{link=}\StringTok{\textquotesingle{}logit\textquotesingle{}}\NormalTok{),}\DataTypeTok{data=}\NormalTok{train)}
\KeywordTok{summary}\NormalTok{(model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = HiResIrr ~ ., family = binomial(link = "logit"), 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1999  -0.5570  -0.3719  -0.2499   2.8841  
## 
## Coefficients:
##                                  Estimate        Std. Error z value
## (Intercept)             -115.962396952931   47.535119512738  -2.440
## month02                    0.283263898648    0.287384733046   0.986
## month03                    0.268087791079    0.292944928637   0.915
## month04                    0.354008960996    0.284999727342   1.242
## month05                    0.822327630847    0.274118138173   3.000
## month06                    0.738722950314    0.277826836533   2.659
## month07                    1.184888739088    0.270106101184   4.387
## month08                    1.531516976149    0.268954742029   5.694
## month09                    1.396497954700    0.271889900322   5.136
## month10                    1.235925304046    0.269595393645   4.584
## month11                    0.801228533561    0.287030089686   2.791
## month12                    0.521886160942    0.291221768812   1.792
## year                       0.055649003832    0.023577081824   2.360
## irrigation_multi_family   -0.000000426759    0.000000036306 -11.755
## multi_family               0.000000027343    0.000000003148   8.687
## residential                0.000000049457    0.000000002667  18.543
##                                     Pr(>|z|)    
## (Intercept)                          0.01471 *  
## month02                              0.32430    
## month03                              0.36011    
## month04                              0.21419    
## month05                              0.00270 ** 
## month06                              0.00784 ** 
## month07                         0.0000115055 ***
## month08                         0.0000000124 ***
## month09                         0.0000002803 ***
## month10                         0.0000045536 ***
## month11                              0.00525 ** 
## month12                              0.07312 .  
## year                                 0.01826 *  
## irrigation_multi_family < 0.0000000000000002 ***
## multi_family            < 0.0000000000000002 ***
## residential             < 0.0000000000000002 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 3055.8  on 3315  degrees of freedom
## Residual deviance: 2385.8  on 3300  degrees of freedom
## AIC: 2417.8
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\hypertarget{c-compute-the-confusion-matrix-and-overall-fraction-of-correct-predictions.-explain-what-the}{%
\paragraph{(c) Compute the confusion matrix and overall fraction of
correct predictions. Explain what
the}\label{c-compute-the-confusion-matrix-and-overall-fraction-of-correct-predictions.-explain-what-the}}

confusion matrix is telling you about the types of mistakes made by
logistic regression.

Based on this model, with a threshold of 50\%, there is a high number of
false positives relative to true positives.Overall it was correct
\(\frac{48 + 887}{1106}\) =\(.84\) of the time.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(caret)}
\NormalTok{p <{-}}\StringTok{ }\KeywordTok{predict}\NormalTok{(model, test, }\DataTypeTok{type =} \StringTok{"response"}\NormalTok{)}
\KeywordTok{print}\NormalTok{(}\KeywordTok{summary}\NormalTok{(p))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.01321 0.05412 0.10028 0.17570 0.22754 0.97395
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p\_class <{-}}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(p }\OperatorTok{>}\StringTok{ }\FloatTok{0.5}\NormalTok{, }\StringTok{"Predict 1"}\NormalTok{, }\StringTok{"Predict 0"}\NormalTok{)}
\KeywordTok{print}\NormalTok{(}\KeywordTok{table}\NormalTok{(p\_class, test[[}\StringTok{"HiResIrr"}\NormalTok{]]))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            
## p_class       0   1
##   Predict 0 887 144
##   Predict 1  27  48
\end{verbatim}

\hypertarget{d-split-the-data-into-a-training-set-80-and-a-test-set-20.-perform-knn-with-several-values-of-k}{%
\paragraph{(d) Split the data into a training set (80\%) and a test set
(20\%). Perform KNN with several values of
K}\label{d-split-the-data-into-a-training-set-80-and-a-test-set-20.-perform-knn-with-several-values-of-k}}

and all the variables from (b) in order to predict HiResIrr. What test
errors do you obtain? Which value of K seems to perform the best on this
data set? Comment on the sensitivity and specificity

The highest overall prediction rate was reached at k=5. The sensitivity
is, or true positive rate is \(0.614\), while the specificity, or true
negative is relatively higher at \(0.936\)

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(class)}
\KeywordTok{library}\NormalTok{(gmodels)}

\NormalTok{dfknn <{-}}\StringTok{ }\NormalTok{dfwide}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(dfknn}\OperatorTok{$}\NormalTok{irrigation\_residential))\{}
                  \ControlFlowTok{if}\NormalTok{(dfknn}\OperatorTok{$}\NormalTok{irrigation\_residential[i] }\OperatorTok{>}\StringTok{ }\KeywordTok{mean}\NormalTok{(dfknn}\OperatorTok{$}\NormalTok{irrigation\_residential))\{        }
\NormalTok{                    dfknn}\OperatorTok{$}\NormalTok{HiResIrr[i] <{-}}\StringTok{ }\DecValTok{1}               
\NormalTok{                  \}}
                  \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{(dfknn}\OperatorTok{$}\NormalTok{irrigation\_residential[i] }\OperatorTok{<=}\StringTok{ }\KeywordTok{mean}\NormalTok{(dfknn}\OperatorTok{$}\NormalTok{irrigation\_residential))\{        }
\NormalTok{                    dfknn}\OperatorTok{$}\NormalTok{HiResIrr[i] <{-}}\StringTok{ }\DecValTok{0} 
\NormalTok{                  \}}
\NormalTok{\}}

\KeywordTok{set.seed}\NormalTok{(}\DecValTok{88}\NormalTok{)}
\NormalTok{dfknn <{-}}\StringTok{ }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{select}\NormalTok{(dfknn, }\OperatorTok{{-}}\KeywordTok{c}\NormalTok{(irrigation\_residential, postal\_code))}
\NormalTok{dmy <{-}}\StringTok{ }\KeywordTok{dummyVars}\NormalTok{(}\StringTok{" \textasciitilde{} ."}\NormalTok{, }\DataTypeTok{data =}\NormalTok{ dfknn)}
\NormalTok{dfknn <{-}}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{predict}\NormalTok{(dmy, }\DataTypeTok{newdata =}\NormalTok{ dfknn))}
\NormalTok{split =}\StringTok{ }\KeywordTok{sample.split}\NormalTok{(dfknn}\OperatorTok{$}\NormalTok{HiResIrr, }\DataTypeTok{SplitRatio =} \FloatTok{0.8}\NormalTok{)}
\NormalTok{train\_knn =}\StringTok{ }\KeywordTok{subset}\NormalTok{(dfknn, split }\OperatorTok{==}\StringTok{ }\OtherTok{TRUE}\NormalTok{)}
\NormalTok{train\_labels =}\StringTok{ }\NormalTok{train\_knn[[}\StringTok{"HiResIrr"}\NormalTok{]]}
\NormalTok{train\_knn[}\KeywordTok{is.na}\NormalTok{(train\_knn)] <{-}}\StringTok{ }\DecValTok{0}

\NormalTok{test\_knn =}\StringTok{ }\KeywordTok{subset}\NormalTok{(dfknn, split }\OperatorTok{==}\StringTok{ }\OtherTok{FALSE}\NormalTok{)}
\NormalTok{test\_labels =}\StringTok{ }\NormalTok{test\_knn[[}\StringTok{"HiResIrr"}\NormalTok{]]}
\NormalTok{test\_knn[}\KeywordTok{is.na}\NormalTok{(test\_knn)] <{-}}\StringTok{ }\DecValTok{0}


\NormalTok{dfknn\_prediction =}\StringTok{ }\NormalTok{class}\OperatorTok{::}\KeywordTok{knn}\NormalTok{(}\DataTypeTok{train=}\NormalTok{ train\_knn, }\DataTypeTok{test =}\NormalTok{ test\_knn, }\DataTypeTok{cl=}\NormalTok{ train\_labels, }\DataTypeTok{k =} \DecValTok{4}\NormalTok{)}
\KeywordTok{CrossTable}\NormalTok{(}\DataTypeTok{x=}\NormalTok{ test\_labels, }\DataTypeTok{y=}\NormalTok{ dfknn\_prediction, }\DataTypeTok{chisq =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## | Chi-square contribution |
## |           N / Row Total |
## |           N / Col Total |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  884 
## 
##  
##              | dfknn_prediction 
##  test_labels |         0 |         1 | Row Total | 
## -------------|-----------|-----------|-----------|
##            0 |       684 |        47 |       731 | 
##              |     7.883 |    41.542 |           | 
##              |     0.936 |     0.064 |     0.827 | 
##              |     0.921 |     0.333 |           | 
##              |     0.774 |     0.053 |           | 
## -------------|-----------|-----------|-----------|
##            1 |        59 |        94 |       153 | 
##              |    37.665 |   198.478 |           | 
##              |     0.386 |     0.614 |     0.173 | 
##              |     0.079 |     0.667 |           | 
##              |     0.067 |     0.106 |           | 
## -------------|-----------|-----------|-----------|
## Column Total |       743 |       141 |       884 | 
##              |     0.840 |     0.160 |           | 
## -------------|-----------|-----------|-----------|
## 
## 
\end{verbatim}

\#\#\#\#(e) Perform LDA on the training data in order to predict
HiResIrr using all the variables from (b) as predictors. What is the
test error of the model obtained? Comment on the sensitivity and
specificity.

The overall test error is \(0.164557\).The Sensitivity of the LDA
function is high at \(0.9530\), but the specificity is low at
\(0.2760\).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(MASS)}

\NormalTok{fit <{-}}\StringTok{ }\KeywordTok{lda}\NormalTok{(HiResIrr }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{year }\OperatorTok{+}\StringTok{ }\NormalTok{irrigation\_multi\_family }\OperatorTok{+}\StringTok{ }\NormalTok{multi\_family }\OperatorTok{+}\StringTok{ }\NormalTok{residential, }\DataTypeTok{data=}\NormalTok{train)}

\NormalTok{pred.train <{-}}\StringTok{ }\KeywordTok{predict}\NormalTok{(fit,train)}\OperatorTok{$}\NormalTok{class}
\NormalTok{pred.test <{-}}\StringTok{ }\KeywordTok{predict}\NormalTok{(fit,test)}\OperatorTok{$}\NormalTok{class}

\KeywordTok{mean}\NormalTok{(pred.train }\OperatorTok{==}\StringTok{ }\NormalTok{train}\OperatorTok{$}\NormalTok{HiResIrr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.8477081
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{mean}\NormalTok{(pred.test }\OperatorTok{==}\StringTok{ }\NormalTok{test}\OperatorTok{$}\NormalTok{HiResIrr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.835443
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{confusionMatrix}\NormalTok{(pred.test, }\DataTypeTok{reference =} \KeywordTok{as.factor}\NormalTok{(test}\OperatorTok{$}\NormalTok{HiResIrr))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 871 139
##          1  43  53
##                                            
##                Accuracy : 0.8354           
##                  95% CI : (0.8123, 0.8568) 
##     No Information Rate : 0.8264           
##     P-Value [Acc > NIR] : 0.2265           
##                                            
##                   Kappa : 0.2853           
##                                            
##  Mcnemar's Test P-Value : 0.000000000001897
##                                            
##             Sensitivity : 0.9530           
##             Specificity : 0.2760           
##          Pos Pred Value : 0.8624           
##          Neg Pred Value : 0.5521           
##              Prevalence : 0.8264           
##          Detection Rate : 0.7875           
##    Detection Prevalence : 0.9132           
##       Balanced Accuracy : 0.6145           
##                                            
##        'Positive' Class : 0                
## 
\end{verbatim}

\hypertarget{f-perform-qda-on-the-training-data-in-order-to-predict-hiresirr-using-all-the-variables-from-b-as}{%
\paragraph{(f) Perform QDA on the training data in order to predict
HiResIrr using all the variables from (b)
as}\label{f-perform-qda-on-the-training-data-in-order-to-predict-hiresirr-using-all-the-variables-from-b-as}}

predictors. What is the test error of the model obtained?

The test error for the QDA function was slightly higher than LDA at
\(0.1708861\)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit <{-}}\StringTok{ }\KeywordTok{qda}\NormalTok{(HiResIrr }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{year }\OperatorTok{+}\StringTok{ }\NormalTok{irrigation\_multi\_family }\OperatorTok{+}\StringTok{ }\NormalTok{multi\_family }\OperatorTok{+}\StringTok{ }\NormalTok{residential, }\DataTypeTok{data=}\NormalTok{train)}

\NormalTok{pred.train <{-}}\StringTok{ }\KeywordTok{predict}\NormalTok{(fit,train)}\OperatorTok{$}\NormalTok{class}
\NormalTok{pred.test <{-}}\StringTok{ }\KeywordTok{predict}\NormalTok{(fit,test)}\OperatorTok{$}\NormalTok{class}

\KeywordTok{mean}\NormalTok{(pred.train }\OperatorTok{==}\StringTok{ }\NormalTok{train}\OperatorTok{$}\NormalTok{HiResIrr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.8443908
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{mean}\NormalTok{(pred.test }\OperatorTok{==}\StringTok{ }\NormalTok{test}\OperatorTok{$}\NormalTok{HiResIrr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.8291139
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{confusionMatrix}\NormalTok{(pred.test, }\DataTypeTok{reference =} \KeywordTok{as.factor}\NormalTok{(test}\OperatorTok{$}\NormalTok{HiResIrr))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 864 139
##          1  50  53
##                                           
##                Accuracy : 0.8291          
##                  95% CI : (0.8056, 0.8509)
##     No Information Rate : 0.8264          
##     P-Value [Acc > NIR] : 0.4246          
##                                           
##                   Kappa : 0.2709          
##                                           
##  Mcnemar's Test P-Value : 0.0000000001543 
##                                           
##             Sensitivity : 0.9453          
##             Specificity : 0.2760          
##          Pos Pred Value : 0.8614          
##          Neg Pred Value : 0.5146          
##              Prevalence : 0.8264          
##          Detection Rate : 0.7812          
##    Detection Prevalence : 0.9069          
##       Balanced Accuracy : 0.6107          
##                                           
##        'Positive' Class : 0               
## 
\end{verbatim}

\hypertarget{q3-classification-in-simulated-data-20-points}{%
\section{\texorpdfstring{Q3: Classification in simulated data (20
points)}{Q3: Classification in simulated data (20 points)  }}\label{q3-classification-in-simulated-data-20-points}}

\#\#\#\#(a) Create a data frame with Index from 1-1000. In a variable
called Class, randomly assign each row one of c(``a'',''b'',''c''). Draw
values of X1 and X2 for each class according to the following: Class a:
X1\textasciitilde N(20, 17), X2\textasciitilde N(25, 12), Class b:
X1\textasciitilde N(50, 22), X2\textasciitilde N(65, 19), Class c:
X1\textasciitilde N(75, 20), X2\textasciitilde N(27, 15). Plot the data
as points with X1 on the X-axis, X2 on the Y-axis, and the color
determined by Class (hint: use ggplot). Draw -- by hand -- your estimate
of the Bayes Decision Boundaries.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2)}
\NormalTok{let <{-}}\StringTok{ }\NormalTok{letters[}\DecValTok{1}\OperatorTok{:}\DecValTok{3}\NormalTok{]}
\NormalTok{df <{-}}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\StringTok{"index"}\NormalTok{ =}\StringTok{ }\DecValTok{1}\OperatorTok{:}\DecValTok{1000}\NormalTok{, }\StringTok{"class"}\NormalTok{ =}\StringTok{ }\KeywordTok{sample}\NormalTok{(let, }\DataTypeTok{replace =} \OtherTok{TRUE}\NormalTok{, }\DataTypeTok{size =} \DecValTok{1000}\NormalTok{))}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(df}\OperatorTok{$}\NormalTok{index))\{}
                  \ControlFlowTok{if}\NormalTok{(df}\OperatorTok{$}\NormalTok{class[i] }\OperatorTok{==}\StringTok{ "a"}\NormalTok{)\{        }
\NormalTok{                    df}\OperatorTok{$}\NormalTok{x1[i] <{-}}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{17}\NormalTok{)}
\NormalTok{                    df}\OperatorTok{$}\NormalTok{x2[i] <{-}}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{12}\NormalTok{)}
\NormalTok{                  \}}
                  \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{(df}\OperatorTok{$}\NormalTok{class[i] }\OperatorTok{==}\StringTok{ "b"}\NormalTok{)\{        }
\NormalTok{                    df}\OperatorTok{$}\NormalTok{x1[i] <{-}}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{50}\NormalTok{, }\DecValTok{22}\NormalTok{)}
\NormalTok{                    df}\OperatorTok{$}\NormalTok{x2[i] <{-}}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{65}\NormalTok{, }\DecValTok{19}\NormalTok{)}
\NormalTok{                  \}}
                 \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{(df}\OperatorTok{$}\NormalTok{class[i] }\OperatorTok{==}\StringTok{ "c"}\NormalTok{)\{        }
\NormalTok{                    df}\OperatorTok{$}\NormalTok{x1[i] <{-}}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{75}\NormalTok{, }\DecValTok{20}\NormalTok{)}
\NormalTok{                    df}\OperatorTok{$}\NormalTok{x2[i] <{-}}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{27}\NormalTok{, }\DecValTok{15}\NormalTok{)}
\NormalTok{                  \}}
\NormalTok{\}}



\KeywordTok{ggplot}\NormalTok{(df, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{x1, }\DataTypeTok{y=}\NormalTok{x2, }\DataTypeTok{shape =}\NormalTok{ class, }\DataTypeTok{color =}\NormalTok{ class)) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom\_point}\NormalTok{() }\OperatorTok{+}\StringTok{ }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Q3(a) Scatter Plot"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{assignment2_files/figure-latex/simulated_data-1.pdf}

\hypertarget{b-use-lda-to-predict-class-based-on-x1-and-x2.-plot-the-predicted-classes-just-as-you-did-in-a.}{%
\paragraph{(b) Use LDA to predict class based on X1 and X2. Plot the
predicted classes just as you did in
(a).}\label{b-use-lda-to-predict-class-based-on-x1-and-x2.-plot-the-predicted-classes-just-as-you-did-in-a.}}

Comment on the differences between the two plots in Q3, and evaluate
your hand drawn Bayes Decision Boundaries.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{require}\NormalTok{(MASS)}
\KeywordTok{require}\NormalTok{(ggplot2)}
\KeywordTok{require}\NormalTok{(scales)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: scales
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{require}\NormalTok{(gridExtra)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: gridExtra
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'gridExtra'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     combine
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{88}\NormalTok{)}
\NormalTok{split =}\StringTok{ }\KeywordTok{sample.split}\NormalTok{(df, }\DataTypeTok{SplitRatio =} \FloatTok{0.75}\NormalTok{)}
\NormalTok{train =}\StringTok{ }\KeywordTok{subset}\NormalTok{(df, split }\OperatorTok{==}\StringTok{ }\OtherTok{TRUE}\NormalTok{)}
\NormalTok{test =}\StringTok{ }\KeywordTok{subset}\NormalTok{(df, split }\OperatorTok{==}\StringTok{ }\OtherTok{FALSE}\NormalTok{)}


\NormalTok{fit <{-}}\StringTok{ }\KeywordTok{lda}\NormalTok{(class }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{x1 }\OperatorTok{+}\StringTok{ }\NormalTok{x2, }\DataTypeTok{data=}\NormalTok{train)}
\NormalTok{pred <{-}}\StringTok{ }\KeywordTok{predict}\NormalTok{(fit, test)}\OperatorTok{$}\NormalTok{class}
\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ test, }\KeywordTok{aes}\NormalTok{(x1, x2, }\DataTypeTok{color=}\NormalTok{pred)) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{assignment2_files/figure-latex/lda_simulated-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ test, }\KeywordTok{aes}\NormalTok{(x1,x2, }\DataTypeTok{color=}\NormalTok{class)) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{assignment2_files/figure-latex/lda_simulated-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ldacorrect =}\StringTok{ }\KeywordTok{mean}\NormalTok{(pred }\OperatorTok{==}\StringTok{ }\NormalTok{df}\OperatorTok{$}\NormalTok{class)}
\NormalTok{ldaerror =}\StringTok{ }\DecValTok{1}\OperatorTok{{-}}\StringTok{ }\NormalTok{ldacorrect}
\NormalTok{ldaerror}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.652
\end{verbatim}


\end{document}
