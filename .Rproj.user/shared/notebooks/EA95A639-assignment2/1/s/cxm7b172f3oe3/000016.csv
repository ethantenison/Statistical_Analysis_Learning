"0","library(class)"
"0","library(gmodels)"
"0",""
"0","dfknn <- dfwide"
"0","for (i in 1:length(dfknn$irrigation_residential)){"
"0","                  if(dfknn$irrigation_residential[i] > mean(dfknn$irrigation_residential)){        "
"0","                    dfknn$HiResIrr[i] <- 1               "
"0","                  }"
"0","                  else if(dfknn$irrigation_residential[i] <= mean(dfknn$irrigation_residential)){        "
"0","                    dfknn$HiResIrr[i] <- 0 "
"0","                  }"
"0","}"
"0",""
"0","set.seed(88)"
"0","dfknn <- dplyr::select(dfknn, -c(irrigation_residential, postal_code))"
"0","dmy <- dummyVars("" ~ ."", data = dfknn)"
"0","dfknn <- data.frame(predict(dmy, newdata = dfknn))"
"0","split = sample.split(dfknn$HiResIrr, SplitRatio = 0.8)"
"0","train_knn = subset(dfknn, split == TRUE)"
"0","train_labels = train_knn[[""HiResIrr""]]"
"0","train_knn[is.na(train_knn)] <- 0"
"0",""
"0","test_knn = subset(dfknn, split == FALSE)"
"0","test_labels = test_knn[[""HiResIrr""]]"
"0","test_knn[is.na(test_knn)] <- 0"
"0",""
"0",""
"0","dfknn_prediction = class::knn(train= train_knn, test = test_knn, cl= train_labels, k = 4)"
"0","CrossTable(x= test_labels, y= dfknn_prediction, chisq = FALSE)"
"1","
"
"1"," "
"1","
"
"1","   Cell Contents
"
"1","|-------------------------|
"
"1","|                       N |
"
"1","| Chi-square contribution |
"
"1","|           N / Row Total |
"
"1","|           N / Col Total |
"
"1","|         N / Table Total |
"
"1","|-------------------------|
"
"1","
"
"1"," "
"1","
"
"1","Total Observations in Table: "
"1"," "
"1","884"
"1"," "
"1","
"
"1","
"
"1"," "
"1","
"
"1","            "
"1"," "
"1","|"
"1"," "
"1","dfknn_prediction"
"1"," "
"1","
"
"1"," test_labels"
"1"," | "
"1","        0"
"1"," | "
"1","        1"
"1"," | "
"1","Row Total"
"1"," | "
"1","
"
"1","-------------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","
"
"1","           0"
"1"," | "
"1","      684"
"1"," | "
"1","       47"
"1"," | "
"1","      731"
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","    7.883"
"1"," | "
"1","   41.542"
"1"," | "
"1","         "
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","    0.936"
"1"," | "
"1","    0.064"
"1"," | "
"1","    0.827"
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","    0.921"
"1"," | "
"1","    0.333"
"1"," | "
"1","         "
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","    0.774"
"1"," | "
"1","    0.053"
"1"," | "
"1","         "
"1"," | "
"1","
"
"1","-------------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","
"
"1","           1"
"1"," | "
"1","       59"
"1"," | "
"1","       94"
"1"," | "
"1","      153"
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","   37.665"
"1"," | "
"1","  198.478"
"1"," | "
"1","         "
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","    0.386"
"1"," | "
"1","    0.614"
"1"," | "
"1","    0.173"
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","    0.079"
"1"," | "
"1","    0.667"
"1"," | "
"1","         "
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","    0.067"
"1"," | "
"1","    0.106"
"1"," | "
"1","         "
"1"," | "
"1","
"
"1","-------------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","
"
"1","Column Total"
"1"," | "
"1","      743"
"1"," | "
"1","      141"
"1"," | "
"1","      884"
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","    0.840"
"1"," | "
"1","    0.160"
"1"," | "
"1","         "
"1"," | "
"1","
"
"1","-------------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","
"
"1","
"
"1"," "
"1","
"
